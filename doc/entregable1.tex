\documentclass[12pt,bibliography=openstyle,DIV=12,parskip=half-]{scrartcl}
\include{conf/preconfig}
\include{conf/packages}
\include{conf/config}
\include{conf/comandos}
\include{conf/fuentes}
%
\addbibresource{biblio.bib}
%
\selectlanguage{spanish}
\hyphenation{micro-RNA}
\hyphenation{micro-RNAs}
\hyphenation{mi-RNA}
\hyphenation{mi-RNAs}
%
\begin{document}
\selectlanguage{spanish}
%
% pagina de titulo
\begin{titlepage}
%
\titlehead{\center Universidad Nacional del Litoral\\
  Facultad de Ingeniería y Ciencias Hídricas}
%
\subtitle{Ingeniería en Informática\\
  Propuesta de Proyecto Final de Carrera}
%
\title{Desarrollo de un clasificador de secuencias de pre-microRNA
  mediante técnicas de Inteligencia Computacional}
\subject{Informe entregable 1}
\author{Mauro Javier Torrez}
%
\publishers{\-\\[4em]{Director\\Dr. Diego H. Milone}\\[2em]
  {Asesora temática\\Dra. Georgina S. Stegmayer}}
%
\date{\-\\[2em]\today}
%
\renewcommand*{\titlepagestyle}{empty}
%\thispagestyle{empty}
\maketitle
\end{titlepage}
\setcounter{page}{1}
%
%
%
%
\section{Bibliografía consultada}
%
A continuación se detalla la bibliografía consultada junto con una
breve descripción de cada una de las publicaciones.
%
\subsection{C. Xue et al. \cite{xue}}
%
En este trabajo se presenta un clasificador de secuencias de
pre-microRNA mediante SVM.  En el clasificador se utiliza un conjunto
de características de tipo estructura-secuencia, utilizando como
entrada al clasificador un vector de frecuencia de 32 ``triplets'' que
combinan el nucleótido de la secuencia con la estructura secundaria
del entorno donde éste se presenta.
%
\subsection{S. K. L. NG y S. K. Mishra \cite{ng}}
%
En este trabajo se presenta un clasificador de secuencias de
pre-microRNA mediante SVM.

El conjunto de características utilizado consiste en 29 medidas
``globales e intrínsecas'' a la secuencia y su estructura secundaria:
(1) 17 medidas de composición de la secuencia: frecuencia de
ocurrencia de dinucleótidos
$\mono{XY}:(\mono{X},\mono{Y})\in\{\mono{A},\mono{G},\mono{C},\mono{U}\}$
y frecuencia agregada de ocurrencia de los nucleótidos \mono{G} y
\mono{C}; (2) 6 medidas de plegado basadas en la mínima energía libre
y la distribución de los \resalt{base pairs}; (3) un descriptor
topológico; y (4) 5 variantes normalizadas de estas características.

El método además es probado para detectar pre-miRNAs en genes de
virus, recorriendo éste mediante una ventana deslizante de 95nt y
clasificando las secuencias extraídas.
%
\subsection{R. Batuwita y V. Palade \cite{batuwita}}
%
En este paper se describe un método de clasificación de pre-miRNAs que
elabora sobre \cite{ng} incorporando características basadas en la
mínima energía libre, otras características relacionadas el programa
RNAfold, y características basadas en los \resalt{base pairs}.

Se discute acerca de la relevancia de cada una de las características
y se presenta luego un conjunto reducido de éstas para mejorar la
performance del clasificador, y también se discute acerca del problema
de \resalt{``desbalance''} de clases, siempre presente en la
clasificación de pre-miRNAs.
%
%
%
%
\section{Bases de datos recopiladas}
%
\subsection{Triplet-SVM \cite{xue}}
%
Si bien en la página del autor ya no están disponibles los datos,
éstos se pueden encontrar en una versión anterior de la misma,
disponible en el archivo de internet:
\url{http://web.archive.org/web/20120210235054/http://bioinfo.au.tsinghua.edu.cn/software/mirnasvm/}

En esta base de datos cada una de las entradas presenta las siguientes
características:
\begin{description*}
%
\item[identificador] de la entrada (p. ej. \mono{hsa-mir-100}).
%
\item[secuencia] en forma de cadena de caracteres \mono{A}, \mono{G},
  \mono{C}, \mono{U}.
%
\item[estructura secundaria] correspondiente a la secuencia, tal como
  se obtiene con el programa RNAfold\cite{vienna}. Se presenta como
  una cadena de caracteres \mono{(}, \mono{.}, \mono{)}.
%
\item[\mono{SEQ\_LENGTH}] indica la longitud de la secuencia
  considerada para el armado del vector de características. Cuenta
  aquellos nucleótidos que pertenecen al ``tallo'' del pre-miRNA.
%
\item[\mono{GC\_CONTENT}] se define según
  $\frac{\T{cant}(\mono{G})+\T{cant}(\mono{C})}{\mono{SEQ\_LENGTH}}$
  donde $\T{cant}(x)$ cuenta el número de ocurrencia del nucleótido
  $x$ en el tallo del pre-miRNA.
%
\item[\mono{BASEPAIR}] cuenta la cantidad de nucleótidos
  \resalt{emparejados} en el pre-miRNA.
%
\item[\mono{FREE\_ENERGY}] indica la mínima energía libre de plegado
  obtenida con RNAfold.
%
\item[\mono{LEN\_BP\_RATIO}] se define según
  $\frac{\mono{SEQ\_LENGTH}}{\mono{BASEPAIR}}$.
\end{description*}
%
El vector de 32 triplets utilizados en el clasificador no está
directamente disponible, si bien se encuentran los métodos para su
cálculo.
%
\subsubsection{Conjuntos de datos}
\paragraph{pre-miRNAs humanos}
Tomados de miRNA registry rel 5.0, sept/2004
\begin{description*}
\item[Tipo:] Conjunto de entrenamiento (163) y prueba(30), datos
  positivos
\item[Num. entradas:] 193
\item[Especies:] Homo sapiens (hsa)
\end{description*}
\paragraph{CROSS-SPECIES}
Tomados de miRNA registry rel 5.0, sept/2004
\begin{description*}
\item[Tipo:] Conjunto de prueba, datos positivos
\item[Num. entradas:] 581
\item[Especies:]
  \quad mmu (36)
  \quad rno (25)
  \quad gga (13)
  \quad dre (6)
  \quad cbr (73)
  \quad cel (110)
  \quad dps (71)
  \quad dme (71)
  \quad osa (96)
  \quad ath (75)
  \quad ebv (5)
\end{description*}
%
\paragraph{pre-miRNAs humanos (actualizado)}
Tomados de miRNA registry \resalt{rel 5.0}, sept/2004
\begin{description*}
\item[Tipo:] Conjunto de prueba, datos positivos
\item[Num. entradas:] 39
\item[Especies:]  Homo sapiens (hsa)
\end{description*}

\bigskip
Para el armado de los conjuntos de datos negativos se consideran los
siguientes criterios:
\begin{itemize*}
\item Mínimo de 18 \resalt{base pairings} en el tallo
\item Máximo -15kcal/mol de energía libre mínima
\item Ningún bucle múltiple (no más de un ``tallo'' en la estructura
  secundaria)
\end{itemize*}

\paragraph{CONSERVED-HAIRPIN}
Tomados de UCSC database, region 56000001--57000000 del cromosoma
humano 19
\begin{description*}
\item[Tipo:] Conjunto de prueba, datos desconocidos (algunos
  positivos)
\item[Num. entradas:] 2444
\item[Especies:]  Homo sapiens (hsa)
\end{description*}
\paragraph{CODING}
Tomados de USC database, secuencias protein-coding (CDSs)
\begin{description*}
\item[Tipo:] Conjunto de entrenamiento, datos negativos
\item[Num. entradas:] 8494
\item[Especies:]  Homo sapiens (hsa)
\end{description*}
%
%
%
%
%
\subsection{miPred \cite{ng}}
\url{http://web.bii.a-star.edu.sg/archive/stanley/Publications/}
%
En esta base de datos cada entrada dispone de las siguientes características:
\begin{description*}
%
\item[identificador] del pre-miRNA, p. ej. \mono{hsa-let-7a}.
%
\item[secuencia] en forma de cadena de caracteres \mono{A}, \mono{G},
  \mono{C}, \mono{U}.
%
\item[estructura secundaria] correspondiente a la secuencia, como una
  cadena de caracteres \mono{(}, \mono{.}, \mono{)}.
%
\item[longitud] de la secuencia completa.
%
\item[\mono{A}, \mono{G}, \mono{C}, \mono{U}] (x4) representan el
  número de ocurrencias del nucleótido en la secuencia.
%
\item[\mono{G+C}, \mono{A+U}] (x2) corresponden a la suma de las
  ocurrencias de \mono{G} y \mono{C}, y \mono{A} y \mono{U}
  respectivamente.
%
\item[\mono{AA}, \mono{AG}, \mono{AC}, \mono{AU}, \mono{GA},
  \textellipsis, \mono{UU}] (x16) representan el número de ocurrencias
  del dinucleótido correspondiente en la secuencia.
%
\item[\mono{\%A}, \mono{\%G}, \mono{\%C}, \mono{\%U}] (x4) representan
  la frecuencia de ocurrencia del nucleótido correspondiente.
%
\item[\mono{\%(G+C)}, \mono{\%(A+U)}] (x2) representan la frecuencia
  de ocurrencia de \mono{G}+\mono{C} y \mono{A}+\mono{U}.
%
\item[\mono{\%AA}, \mono{\%AG}, \mono{\%AC}, \textellipsis] (x16)
  representan la frecuencia de ocurrencia de los dinucleótidos
  correspondientes.
%
\item[\mono{pb}] indica la cantidad de \resalt{base pairs}.
%
\item[\mono{mfe}] indica la mínima energía libre según RNAFold.
%
\item[\mono{Q}] corresponde a la \resalt{\emph{entropía de Shannon}}.
%
\item[\mono{D}] representa la distancia entre \resalt{base pairs}.
%
\item[\mono{Npb=dP}, \mono{Nmfe=dG}, \mono{NQ=dQ}, \mono{ND=dD}] (x4) corresponde
  a las variables \mono{pb}, \mono{mfe}, \mono{Q}, \mono{D}
  normalizadas por la longitud de la secuencia.
%
\end{description*}
%
%
\subsubsection{Conjuntos de datos}
\paragraph{pre-miRNAs no redundantes}
Tomados de miRBase 8.2 (jul/2006) para todas las especies disponibles,
se filtran aquellas secuencias redundantes mediante un algoritmo de
agrupación incremental ``ávido''\cite{greedy}.
\begin{description*}
\item[Tipo:] Conjunto de datos positivos
\item[Num. entradas:] 2241
\item[Especies:] 45 especies agrupadas en artropoda, nematoda,
  vertebrata, viridiplantae y virus
\end{description*}

\paragraph{ncRNAs funcionales}
Tomados de Rfam 7.0, consiste en un conjunto de ncRNAs de los que se
han eliminado 46 tipos de pre-miRNAs.
\begin{description*}
\item[Tipo:] Conjunto de datos negativos
\item[Num. entradas:] 12387
\item[Especies:] prokaryota y eukaryota (?)
\end{description*}

\paragraph{mRNAs}
Consiste en 31 mRNAs mensajeros que se pliegan en estructuras
complejas con MFEs extremadamente negativas. Tomados de GeneBank DNA
Database.
\begin{description*}
\item[Tipo:] Conjunto de datos negativos
\item[Num. entradas:] 31
\item[Especies:] varias, entre ellas: perro, hsa, mmu, cel, rno, \textellipsis.
\end{description*}

\paragraph{pseudo-hairpins}
Ídem al dataset CODING de triplet-svm, en este caso con más
características extraídas
\begin{description*}
\item[Tipo:] Conjunto de datos negativos
\item[Num. entradas:] 8494
\item[Especies:] homo sapiens (hsa)
\end{description*}
%
%
%
%
%
\subsection{Batuwita et al.: microPred}
En esta base de datos están presentes las características presentadas
en \cite{ng} (salvo estructura secundaria) y se introducen otras 19 
características adicionales. De estas 19 se detallan sólo aquellas que están
basadas en la secuencia y/o estructura secundaria, el resto de características
se basa en descriptores moleculares, y dada su complejidad de cálculo
se consideran fuera del alcance del actual proyecto.
%
Los datos se encuentran disponibles en \url{http://www.cs.ox.ac.uk/people/manohara.rukshan.batuwita/microPred.htm}.
%
\begin{description*}
%
\item[identificador] del pre-miRNA, p. ej. \mono{hsa-let-7a}.
%
\item[secuencia] en forma de cadena de caracteres \mono{A}, \mono{G},
  \mono{C}, \mono{U}.
%
\item[\mono{MFEI$_3$}] corresponde a \mono{dG} dividida entre el número
  de loops (bucles) de la estructura secundaria.
%
\item[\mono{MFEI$_4$}] corresponde a \mono{mfe} dividida entre el número
  de \resalt{base pairs}.
%
\item[\mono{|A-U|/L}, \mono{|G-C|/L}, \mono{|G-U|/L}] (x3) representan
  el número de \resalt{base pairs} \mono{A-U}, \mono{G-C} y \mono{G-U}
  respectivamente, normalizados por la longitud de la secuencia.
%
\item[\mono{Avg\_BP\_Stem}] es el número de \resalt{base pairs} dividido
  entre el número total de tallos en la estructura secundaria.
%
\item[\mono{\%(A-U)/n\_stems}, \mono{\%(G-C)/n\_stems},
  \mono{\%(G-U)/n\_stems}] (x3) donde \mono{\%(X-Y)} es el número de
  \resalt{base pairs} \mono{X-Y} sobre el número total de
  \resalt{base pairs}; este número a su vez dividido entre el número
  total de tallos en la estructura secundaria.
\end{description*}
%
%
\subsubsection{Conjuntos de datos}
\paragraph{pre-miRNAs humanos}
Tomados de miRBase 12. Contiene 660 pre-miRNAs single-loop y 31 multi-loop.
\begin{description*}
\item[Tipo:] Conjunto de datos positivos
\item[Num. entradas:] 691
\item[Especies:] Homo sapiens (hsa)
\end{description*}
%
\paragraph{pseudo-hairpins}
Ídem dataset CODING de Xue, con más características extraídas.
\begin{description*}
\item[Tipo:] Conjunto de datos negativos
\item[Num. entradas:] 8494
\item[Especies:] Homo sapiens (hsa)
\end{description*}
%
\paragraph{Otros ncRNAs humanos}
Base de datos ensamblada manualmente por los autores. Contiene ncRNAs humanos
que no son miRNAs.
\begin{description*}
\item[Tipo:] Conjunto de datos negativos
\item[Num. entradas:] 754
\item[Especies:] Homo sapiens (hsa)
\end{description*}
%
%
%
%
\section{Codificación de clasificadores de prueba}
%
Una vez obtenidas las bases de datos se procedió a codificar
algoritmos de clasificación preliminares.

Se optó por trabajar con el conjunto de datos de \cite{xue}
intentando replicar los resultados obtenidos en ese trabajo mediante
la utilización de herramientas propias.

Como un primer paso se procedió a codificar el programa \mono{fautil}
en el lenguaje Python\footnote{\url{http://www.python.org/}}
para el procesamiento de archivos en formato
FASTA\footnote{\url{http://blast.ncbi.nlm.nih.gov/blastcgihelp.shtml}},
un formato estándar para la representación de secuencias de RNA.
En este caso se considera una ``extensión'' de dicho formato
la salida del programa \mono{RNAFold}, que a los datos de la secuencia
agrega la estructura secundaria, y el valor de la Mínima Energía Libre
para la misma.

La herramienta \mono{fautil} provee las siguientes funcionalidades:
\begin{description*}
\item[\mono{strip}] elimina las secuencias cuya estructura secundaria
  contenga más de un bucle.
\item[\mono{compare}] compara dos conjuntos de secuencias contando
  aquellas presentes en sólo uno de los conjuntos y las presentes en
  ambos. Es de utilidad para asegurar que dos particiones de un
  conjunto (entrenamiento y prueba) no contengan entradas en común.
\item[\mono{triplet}] calcula un vector de \emph{triplets} según el
  procedimiento descripto en \cite{xue}.
\item[\mono{svmout}] genera un archivo con las mismas características
  utilizadas en \cite{xue} para ser utilizado de entrada a la librería
  \emph{libsvm}\cite{svm}.
\item[\mono{fannout}] genera un archivo con las mismas características
  utilizadas en \cite{xue} para ser utilizado de entrada a la librería
  \emph{libfann}\footnote{\url{http://leenissen.dk/fann/wp/}}.
\end{description*}

\section{Métodos de extracción de características}
Se procedió a codificar un algoritmo para la extracción de características
a partir de las bases de datos recopiladas.

Se codificó un método de validación de las características extraídas, comparando
los datos disponibles en las bases de datos recopiladas con aquellas obtenidas por el método.




A partir de fautil, se codificó una herramienta que permita la
extracción de características extra en la base de datos de xue, junto
con un algoritmo de validación para asegurar que los resultados
obtenidos son los mismos que en el paper original.



\subsection{}
%
%
\printbibliography
%
\end{document}


%% Batuwita et al.: microPred
%% 1. datos disponibles sin plegar, pero con las features calculadas
%% 2. dataset positivo: 695 pre-miRNAs hsa (mirBase 12)
%% 3. datasets negativos:
%% 1. CODING de Xue (8494)
%% 2. otros ncRNAs hsa: 754 (695 con secstruct multi-branched)
%% 1. features (48):
%% 1. 29 idem miPred
%% 2. 2 MFE-related
%% 3. 4 RNAfold-related
%% 4. 6 Mfold-related
%% 5. 7 calculadas con scripts propios



%% Sewer et al.: Mir-abela
%% 1. extrae candidatos de miRNAs usando sliding windows en las regiones del genoma que se sabe hay miRNAs
%% 2. especies: human, mouse, rat
%% 3. algunas features “calculables”:
%% 1. energía
%% 2. long del stem simple más largo
%% 3. long del loop del hairpin
%% 4. proporción de nt A/C/G/U en el stem
%% 5. proporción de pares A-U/C-G/G-U en el stem
%% 1. no hay datos de entrenamiento





%% Hertel & Stadler: RNAmicro
%% 1. no hay datos
%% 2. features sacables:
%% 1. long stem
%% 2. long loop
%% 3. G+C

%% Helvik et al.: Microprocessor SVM
%% 1. no hay datos
%% 2. valida con 332 miRNAs hsa (miRBase 8.0) + 130 miRNAs (miRBase 8.1)
%% 3. plega con RNAfold default
%% 4. muchas features

%% Yousef et al.: BayesmiRNAfind
%% 1. no hay datos (dice que estan como supplementary data pero en Bioinformatics no están, tampoco en el sitio bioinfo.wistar.upenn.edu)
%% 2. dataset positivo: no queda claro de dónde lo sacó (pasando un sliding window por las regiones candidatas? de mirbase?)
%% 3. dataset negativo: 190739 no-miRNAs sacados aleatoriamente de las 3’UTR de mRNAs humanos.

%% Nam et al: ProMiR
%% 1. no hay datos, solo disponible el dataset positivo, sin plegar, en http://rfam.sanger.ac.uk
%% 2. no usa “features”, sino estados de transición en la secuencia para entrenar un clasificador HMM
%% Jiang et al.: MiPred
%% 1. dataset positivo: mirna registry database, release 8.2
%% 2. dataset negativo: CODING de Xue
%% 3. features(34): Xue + MFE + P-value
%% 4. disponible: 163 hsa (+), 168 random (-), sin plegar, sin características extraídas. Aparentemente idem Xue.



%% Huang et al.: MiRFinder
%% 1. datos no tan disponibles (train sin etiquetar, sólo vectores libsvm, test sólo secuencias, sin features) 
%% 2. features (18):
%% 1. 1: Minimum Free Energy
%% 2. 2: The difference of the MFE of the sequence pair
%% 3. 3: The difference of the structure of the sequence pair
%% 4. 4–7: Base pairing and other properties of the 22 mer hypothesized mature miRNA
%% 5. 8: The mutation frequency of the sequence segment pair
%% 6. 9–18: The frequency of the 10 possible secondary structure elements (combinations of 2 adjacent characters) in the pseudo code of stem region (represented by the new syntax)
%% 1. training (+): vectores libSVM sin etiquetar: mirBase 8.2 human, mouse, pig, cattle, dog, sheep
%% 2. training (-): sequence segments extracted from UCSC genome pair-wise alignments (human, mouse)
%% Lim et al.: mirCheck/mirScan
%% 1. no hay datos
%% 2. especies: C. elegans
%% 3. features:
%% 1. base pairing of the miRNA portion of the fold-back
%% 2. base pairing of the rest of the fold-back
%% 3. stringent sequence conservation in the 5Ј half of the miRNA
%% 4. slightly less stringent sequence conservation in the 3Ј half of the miRNA
%% 5.  sequence biases in the first five bases of the miRNA (especially a U at the first position)
%% 6. a tendency toward having symmetric rather than asymmetric internal loops and bulges in the miRNA region
%% 7. and the presence of two to nine consensus base pairs between the miRNA and the terminal loop region, with a preference for 4–6 bp.
%% Gkirtzou et al: MatureBayes
%% 1. datos no disponibles
%% 2. conjunto train:
%% 1. 533 hsa, 422 rno de mirBase 10.0
%% 1. test:
%% 1. entradas nuevas de hsa, rno en mirBase 11.0-14.0
%% 2. especies dme, zebrafish en mirBase 14
%% 1. no se usan features útiles para un clasificador svm
%% Lai et al.: MiRSeeker
%% 1. no hay datos
%% 2. scope del paper distinto al nuestro
%% Ding et al.: MiRenSVM
%% 1. training:
%% 1. (+) 692 hsa, 52 aga de mirBase 12.0
%% 2. (-) 9225 hsa, 92 aga de UTRdb release 22.0 (long 70-150nt)
%% 3. (-) 754 ncRNAs hsa usados en microPred
%% 4. (-) 256 ncRNAs aga de Rfam 9.1 (<150nt)
%% 1. test:
%% 1. (+) 14 hsa, 14 aga nuevos en mirBase 13.0
%% 2. (+) 5328 pre-miRNAs de otras 27 especies
%% 3. (-) ??? aparentemente parte de los de UTRdb en train (usa sólo 5428 para entrenar)
%% 1. datos no disponibles, aunque se pueden armar los datasets a mano (secuencias disponibles, hace falta plegar, armar conjuntos train/test)
%% 2. features de miPred + features de microPred
%% miPredGA
%% 1. train:
%% 1. (+) idem microPred
%% 2. (-) idem microPred (CODING de Xue + 754 ncRNAs)
%% 1. test:
%% 1. separa del dataset de train
%% 1. features:
%% 1. idem microPred, rankeadas según libSVM
%% 1. datos disponibles de microPred. no aporta nada nuevo en lo que hace los datos. 
%% Sheng et al.: mirCos
%% 1. no sirve
%% Xu et al.: miRank
%% 1. features:
%% 1. 1 MFE normalizada
%% 2. 2 base pairing propensity normalizada (1para c/brazo)
%% 3. 1 long del loop normalizada
%% 4. 32 triplets como Xue
%% 1. train:
%% 1. (+) 533 hsa, 38 aga de mirBase 1/9/2007
%% 2. (-) 1000 hsa, 20000+ aga obtenidos escaneando el genoma con ventanas de 90nt y filtrando por caracts. de plegado
%% 1. test: no especificado
%% 2. datos disponibles: sólo hsa, formato svm, sin info de secuencia/estructura secundaria

